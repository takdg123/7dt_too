{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import axios from'axios';import'../styles/TargetForm.css';import{Autocomplete,Alert,TextField,Button,RadioGroup,FormControlLabel,Radio,Checkbox,Dialog,DialogTitle,DialogContent,DialogActions,Snackbar,CircularProgress}from'@mui/material';import'chartjs-adapter-date-fns';import{Chart as ChartJS,LinearScale,Title,Tooltip,ScatterController,LineController,LineElement,PointElement,CategoryScale,TimeScale,Legend}from'chart.js';import annotationPlugin from'chartjs-plugin-annotation';import ExpandMoreIcon from'@mui/icons-material/ExpandMore';import ExpandLessIcon from'@mui/icons-material/ExpandLess';import SpecMode from'./SpecMode';import DeepMode from'./DeepMode';import DetailedSettings from'./DetailedSettings';import CircleIcon from'@mui/icons-material/Circle';import moment from'moment-timezone';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";ChartJS.register(LinearScale,Title,Tooltip,ScatterController,LineController,LineElement,PointElement,CategoryScale,TimeScale,Legend,annotationPlugin);const TargetForm=()=>{const[targets,setTargets]=useState([]);const[target,setTarget]=useState('');const[ra,setRa]=useState('');const[dec,setDec]=useState('');const[exposure,setExposure]=useState('300');const[obsmode,setObsmode]=useState('Spec');const[comments,setComments]=useState('');const[abortObservation,setAbortObservation]=useState(false);// Track checkbox state\nconst[requester,setRequester]=useState('');// Track requester email\nconst[wavelengths,setWavelengths]=useState([]);const[filters,setFilters]=useState([]);const[specFileOptions,setSpecFileOptions]=useState(['specall.specmode']);const[selectedSpecFile,setSelectedSpecFile]=useState('specall.specmode');const[selectedFilters,setSelectedFilters]=useState(['g']);// For checkboxes\nconst[selectedTelNumber,setSelectedTelNumber]=useState(10);// For dropdown\nconst[staraltData,setStaraltData]=useState(null);const[isCustomTarget,setIsCustomTarget]=useState(true);const[isCollapsed,setIsCollapsed]=useState(true);// Collapse state for mode options\nconst[isDetailCollapsed,setIsDetailCollapsed]=useState(true);// Collapse state for mode options\nconst[isStaraltCollapsed,setIsStaraltCollapsed]=useState(false);// Collapse state for mode options\nconst[isDialogOpen,setIsDialogOpen]=useState(false);// Dialog state\nconst[isLoading,setIsLoading]=useState(false);const[error,setError]=useState('');const[successMessage,setSuccessMessage]=useState('');const[detailedSettings,setDetailedSettings]=useState({singleFrameExposure:60,// Default 60 seconds\nimageCount:5,// Default exposure time / 60\npriority:50,// Default 50\ngain:2750,// Default 2750\nbinning:1,// Default 1\nobsStartTime:''// Default empty\n});const[telescopesOnline,setTelescopesOnline]=useState(0);// New state for telescope status\nconst[localTime,setLocalTime]=useState(moment().tz(\"America/Santiago\").format('YYYY-MM-DD HH:mm:ss'));const chartRef=useRef(null);const staraltChartRef=useRef(null);useEffect(()=>{axios.get('/api/targets').then(response=>setTargets(response.data)).catch(error=>console.error('Error fetching targets:',error));},[]);useEffect(()=>{if(obsmode==='Spec'){axios.get('/api/spec-options').then(response=>setSpecFileOptions(response.data)).catch(error=>console.error('Error fetching spec file options:',error));}},[obsmode]);useEffect(()=>{if(selectedSpecFile){axios.get(`/api/spec-file?file=${selectedSpecFile}`).then(response=>{setWavelengths(response.data.wavelengths);setFilters(response.data.filters);}).catch(error=>console.error('Error fetching spec file data:',error));}},[selectedSpecFile]);useEffect(()=>{axios.get('/api/status').then(response=>{const onlineTelescopes=response.data.table.filter(telescope=>telescope.Status!=='offline').length;setTelescopesOnline(onlineTelescopes);}).catch(error=>console.error('Error fetching telescope status:',error));},[]);useEffect(()=>{const raNum=parseFloat(ra);const decNum=parseFloat(dec);if(!isNaN(raNum)&&!isNaN(decNum)){const query=`ra=${raNum}&dec=${decNum}&objname=${encodeURIComponent(target)}&target_minalt=30&target_minmoonsep=40`;fetch(`/api/staralt_data?${query}`).then(response=>response.json()).then(data=>{setStaraltData(data);console.log(\"Received staralt data:\",data);}).catch(error=>console.error(\"Error fetching staralt data:\",error));}},[ra,dec,target]);useEffect(()=>{if(!staraltData||!staraltChartRef.current)return;const{objname,target_times,target_alts,moon_times,moon_alts,sun_times,sun_alts,color_target,tonight,target_minalt,target_minmoonsep}=staraltData;// Convert times to Date objects\nconst targetData=target_times.map((t,i)=>({x:new Date(t),y:target_alts[i]}));const moonData=moon_times.map((t,i)=>({x:new Date(t),y:moon_alts[i]}));const sunData=sun_times.map((t,i)=>({x:new Date(t),y:sun_alts[i]}));// Map color codes to CSS colors\nconst mappedColorTarget=color_target.map(c=>{if(c==='r')return'red';if(c==='k')return'black';if(c==='g')return'green';return c;// fallback if needed\n});// Convert night times to Date objects\nconst sunsetNight=new Date(tonight.sunset_night);const sunriseNight=new Date(tonight.sunrise_night);const sunsetCivil=new Date(tonight.sunset_civil);const sunriseCivil=new Date(tonight.sunrise_civil);const targetDataset={label:'Target',data:targetData,pointBackgroundColor:mappedColorTarget,borderColor:'black',showLine:false,pointRadius:2};const moonDataset={label:'Moon',data:moonData,borderColor:'blue',backgroundColor:'blue',showLine:false,pointRadius:1};const sunDataset={label:'Sun',data:sunData,borderColor:'red',backgroundColor:'red',showLine:false,pointRadius:1};const annotations={// Vertical line at night start\nnightStartLine:{type:'line',xMin:sunsetNight.getTime(),xMax:sunsetNight.getTime(),borderColor:'black',borderWidth:1,label:{enabled:true,content:'Night start',position:'start',yAdjust:-20}},// Vertical line at night end\nnightEndLine:{type:'line',xMin:sunriseNight.getTime(),xMax:sunriseNight.getTime(),borderColor:'black',borderWidth:1,label:{enabled:true,content:'Night end',position:'start',yAdjust:-20}},// Shaded nighttime region\nnightBox:{type:'box',xMin:sunsetNight.getTime(),xMax:sunriseNight.getTime(),yMin:0,yMax:90,backgroundColor:'rgba(0,0,0,0.3)',drawTime:'beforeDatasetsDraw'},// Shaded civil twilight region\ncivilBox:{type:'box',xMin:sunsetCivil.getTime(),xMax:sunriseCivil.getTime(),yMin:0,yMax:90,backgroundColor:'rgba(0,0,0,0.1)',drawTime:'beforeDatasetsDraw'},// Fill below minimum altitude line (red zone)\nminAltFill:{type:'box',xMin:sunsetNight.getTime(),xMax:sunriseNight.getTime(),yMin:0,yMax:target_minalt,backgroundColor:'rgba(255,0,0,0.3)',drawTime:'beforeDatasetsDraw',label:{enabled:true,content:'Observation limit',position:'center',yAdjust:-50,font:{weight:'bold',size:12},color:'darkred'}},// Add a text annotation with criteria\ncriteriaText:{type:'label',xValue:new Date(sunsetNight.getTime()-0.7*3600000),// 0.7 hours before night start\nyValue:80,backgroundColor:'rgba(255,255,255,0.7)',borderColor:'black',borderWidth:1,color:'black',font:{size:10,weight:'bold'},textAlign:'left',content:[`Current observation criteria:`,`- Altitude > ${target_minalt} deg`,`- Moon separation > ${target_minmoonsep} deg`]}};// If the chart instance exists, update data and annotations\nif(staraltChartRef.current._chart){const chart=staraltChartRef.current._chart;chart.data.datasets=[sunDataset,moonDataset,targetDataset];chart.options.plugins.title.text=objname?`Altitude of ${objname}`:'Altitude of the Target';chart.options.plugins.annotation.annotations=annotations;chart.update();}else{// Otherwise, create a new chart\nconst ctx=staraltChartRef.current.getContext('2d');const chart=new ChartJS(ctx,{type:'line',data:{datasets:[sunDataset,moonDataset,targetDataset]},options:{responsive:true,maintainAspectRatio:false,// Allow the chart to fill its container\nlayout:{padding:10},scales:{x:{type:'time',time:{unit:'hour'},title:{display:true,text:'Time (UTC)'}},y:{title:{display:true,text:'Altitude [deg]'},min:0,max:90}},plugins:{title:{display:true,text:objname?`Altitude of ${objname}`:'Altitude of the Target'},legend:{display:true,position:'chartArea',labels:{boxWidth:10,boxHeight:10,padding:10}},tooltip:{mode:'nearest',intersect:false},annotation:{annotations:annotations}},interaction:{mode:'nearest',intersect:false}}});staraltChartRef.current._chart=chart;}},[staraltData,isStaraltCollapsed]);useEffect(()=>{if(!chartRef.current)return;const ctx=chartRef.current.getContext('2d');let wavelengthChart=ChartJS.getChart(ctx);if(!wavelengthChart){wavelengthChart=new ChartJS(ctx,{type:'scatter',data:{labels:[''],datasets:[]},options:{responsive:true,maintainAspectRatio:false,scales:{x:{type:'linear',min:3500,max:9500,title:{display:false}},y:{display:false}},plugins:{legend:{display:false}}},plugins:[{id:'customSpans',beforeDraw:chart=>{const ctx=chart.ctx;const xScale=chart.scales.x;wavelengths.forEach(wav=>{const xMin=xScale.getPixelForValue((wav-12.5)*10);const xMax=xScale.getPixelForValue((wav+12.5)*10);const xCenter=xScale.getPixelForValue(wav*10);// Create gradient\nconst gradient=ctx.createLinearGradient(xMin,0,xMax,0);gradient.addColorStop(0,'black');gradient.addColorStop(0.1,'darkgreen');gradient.addColorStop(0.5,'green');gradient.addColorStop(0.9,'darkgreen');gradient.addColorStop(1,'black');// Draw the gradient span\nctx.fillStyle=gradient;ctx.fillRect(xMin,chart.chartArea.top,xMax-xMin,chart.chartArea.bottom-chart.chartArea.top);// Draw the center line\nctx.strokeStyle='darkgreen';// You can change the color as needed\nctx.beginPath();ctx.moveTo(xCenter,chart.chartArea.top);ctx.lineTo(xCenter,chart.chartArea.bottom);ctx.stroke();// Draw the horizontal center line\nconst yCenter=(chart.chartArea.top+chart.chartArea.bottom)/2;ctx.beginPath();ctx.moveTo(xMin,yCenter);ctx.lineTo(xMax,yCenter);ctx.stroke();});}}]});}else{wavelengthChart.data.datasets=[];wavelengthChart.update();}return()=>{var _wavelengthChart;return(_wavelengthChart=wavelengthChart)===null||_wavelengthChart===void 0?void 0:_wavelengthChart.destroy();};},[wavelengths,obsmode,isCollapsed]);useEffect(()=>{const interval=setInterval(()=>{setLocalTime(moment().tz(\"America/Santiago\").format('YYYY-MM-DD HH:mm:ss'));},1000);return()=>clearInterval(interval);},[]);const handleSubmit=async e=>{e.preventDefault();setIsLoading(true);setError('');try{await axios.post('http://127.0.0.1:5000/api/send_email',{requester,target,ra,dec,exposure,obsmode,comments,abortObservation,...detailedSettings,...(obsmode==='Deep'&&{selectedFilters,selectedTelNumber}),...(obsmode==='Spec'&&{selectedSpecFile})});setSuccessMessage('Email sent successfully!');setError('');setIsDialogOpen(false);// Close dialog on success\n}catch(error){setError('Failed to send the email. Please try again.');}finally{setIsLoading(false);// Stop loading\n}};const handleInputChange=(event,value)=>{setTarget(value);const selectedTarget=targets.find(t=>t.name===value);if(selectedTarget){setRa(selectedTarget.ra);setDec(selectedTarget.dec);setIsCustomTarget(false);}else{setRa('');setDec('');setIsCustomTarget(true);}};const handleExposureChange=newExposure=>{const{imageCount}=detailedSettings;const newSingleFrameExposure=newExposure/imageCount;setDetailedSettings(prev=>({...prev,singleFrameExposure:newSingleFrameExposure}));setExposure(newExposure);};const handleBlur=()=>{// Remove leading zeros unless they are part of a decimal number\nconst trimmedExposure=exposure.replace(/^0+(?=\\d)/,'').replace(/^0*(\\.\\d+)/,'0$1');setExposure(trimmedExposure);};const handleCheckboxChange=filter=>{setSelectedFilters(prev=>prev.includes(filter)?prev.filter(item=>item!==filter)// Remove filter if unchecked\n:[...prev,filter]// Add filter if checked\n);};const toggleCollapse=()=>{setIsCollapsed(!isCollapsed);};const toggleDetailCollapse=()=>{setIsDetailCollapsed(!isDetailCollapsed);};const toggleStaraltCollapse=()=>{setIsStaraltCollapsed(!isStaraltCollapsed);};const toggleDialog=()=>{// Validate required fields\nif(!ra||!dec||!requester||!target){setError('Fill all required fields: Requester, Target, R.A., Dec.');return;}// Validate email format\nconst emailRegex=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;if(!emailRegex.test(requester)){setError('Please enter a valid email address.');return;}// Check if the target is observable\nconst isObservable=staraltData.color_target.includes('g');if(!isObservable){setError('The entered RA and DEC are not in any observable conditions. Check the visibility plot.');return;}setIsDialogOpen(!isDialogOpen);};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"observing-conditions-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"observing-conditions-header\",children:/*#__PURE__*/_jsx(\"label\",{className:\"status-text\",children:\"Observing Status Overview\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"observing-conditions-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"status-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"default-label\",children:\"Telescope:\"}),/*#__PURE__*/_jsx(CircleIcon,{className:`status-icon ${telescopesOnline>0?'online':'offline'}`}),\"(\",telescopesOnline,\" online)\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"local-time\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"default-label\",children:\"Local Time:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"time-text\",children:localTime}),\" (R\\xEDo Hurtado, Coquimbo, Chile)\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"group-container\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"default-label\",children:\"Requester:\"}),/*#__PURE__*/_jsx(TextField,{label:\"Your email address\",variant:\"outlined\",value:requester,onChange:e=>setRequester(e.target.value),fullWidth:true,className:\"input-field\",size:\"small\",type:\"email\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"group-container\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"default-label\",children:\"Target:\"}),/*#__PURE__*/_jsx(Autocomplete,{options:targets,getOptionLabel:option=>option.name||'',inputValue:target,onInputChange:handleInputChange,renderInput:params=>/*#__PURE__*/_jsx(TextField,{...params,label:\"Target\",variant:\"outlined\",fullWidth:true,size:\"small\",required:true}),freeSolo:true,className:\"input-field\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"group-container\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"default-label\",children:\"R.A.:\"}),/*#__PURE__*/_jsx(TextField,{label:\"hh:mm:ss or degrees\",variant:\"outlined\",value:ra,onChange:e=>setRa(e.target.value),fullWidth:true,disabled:!isCustomTarget,className:\"input-field\",size:\"small\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"group-container\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"default-label\",children:\"Dec.:\"}),/*#__PURE__*/_jsx(TextField,{label:\"dd:mm:ss or degrees\",variant:\"outlined\",value:dec,onChange:e=>setDec(e.target.value),fullWidth:true,disabled:!isCustomTarget,className:\"input-field\",size:\"small\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"group-container\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"default-label\",children:\"Exposure:\"}),/*#__PURE__*/_jsx(TextField,{label:\"seconds\",variant:\"outlined\",value:exposure,onChange:e=>handleExposureChange(e.target.value||0),fullWidth:true,className:\"input-field\",size:\"small\",type:\"number\",onBlur:handleBlur,inputProps:{step:0.1}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"group-container\",style:{justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(\"label\",{className:\"default-label\",children:\"ObsMode:\"}),/*#__PURE__*/_jsxs(RadioGroup,{row:true,value:obsmode,onChange:e=>setObsmode(e.target.value),className:\"radio-group\",children:[/*#__PURE__*/_jsx(FormControlLabel,{value:\"Spec\",control:/*#__PURE__*/_jsx(Radio,{}),label:/*#__PURE__*/_jsx(\"span\",{className:\"bold-label\",children:\"Spec\"})}),/*#__PURE__*/_jsx(FormControlLabel,{value:\"Deep\",control:/*#__PURE__*/_jsx(Radio,{}),label:/*#__PURE__*/_jsx(\"span\",{className:\"bold-label\",children:\"Deep\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"collapse-toggle\",onClick:toggleCollapse,children:[isCollapsed?/*#__PURE__*/_jsx(ExpandMoreIcon,{}):/*#__PURE__*/_jsx(ExpandLessIcon,{}),/*#__PURE__*/_jsx(\"span\",{className:\"collapse-text\",children:isCollapsed?'Expand':'Collapse'})]})]}),!isCollapsed&&/*#__PURE__*/_jsxs(_Fragment,{children:[obsmode==='Spec'&&/*#__PURE__*/_jsx(SpecMode,{specFileOptions:specFileOptions,selectedSpecFile:selectedSpecFile,setSelectedSpecFile:setSelectedSpecFile,chartRef:chartRef,filters:filters}),obsmode==='Deep'&&/*#__PURE__*/_jsx(DeepMode,{selectedFilters:selectedFilters,handleCheckboxChange:handleCheckboxChange,selectedTelNumber:selectedTelNumber,setSelectedTelNumber:setSelectedTelNumber})]}),/*#__PURE__*/_jsx(\"label\",{className:\"default-label\",children:\"Comments:\"}),/*#__PURE__*/_jsx(TextField,{label:\"Any additional information\",variant:\"outlined\",value:comments,onChange:e=>setComments(e.target.value),fullWidth:true,className:\"input-field\",size:\"small\"}),/*#__PURE__*/_jsx(\"div\",{className:\"group-container\",children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{checked:abortObservation,onChange:e=>setAbortObservation(e.target.checked),color:\"primary\"}),style:{fontWeight:'bold'},label:/*#__PURE__*/_jsx(\"span\",{className:\"bold-label\",children:\"Abort Current Observation?\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"collapse-toggle\",style:{marginBottom:\"0\"},onClick:toggleStaraltCollapse,children:[isStaraltCollapsed?/*#__PURE__*/_jsx(ExpandMoreIcon,{}):/*#__PURE__*/_jsx(ExpandLessIcon,{}),/*#__PURE__*/_jsx(\"span\",{className:\"collapse-text\",children:isStaraltCollapsed?'Show Visibility':'Hide Visibility'})]}),!isStaraltCollapsed&&/*#__PURE__*/_jsx(_Fragment,{children:staraltData&&/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',height:'400px'},children:/*#__PURE__*/_jsx(\"canvas\",{ref:staraltChartRef,style:{width:'100%',height:'100%'}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"collapse-toggle\",style:{marginTop:\"0\"},onClick:toggleDetailCollapse,children:[isDetailCollapsed?/*#__PURE__*/_jsx(ExpandMoreIcon,{}):/*#__PURE__*/_jsx(ExpandLessIcon,{}),/*#__PURE__*/_jsx(\"span\",{className:\"collapse-text\",children:isDetailCollapsed?'Show Detailed Settings':'Hide Detailed Settings'})]}),!isDetailCollapsed&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(DetailedSettings,{detailedSettings:detailedSettings,setDetailedSettings:setDetailedSettings,exposure:exposure,setExposure:setExposure})}),/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"contained\",color:\"primary\",className:\"submit-button\",onClick:toggleDialog,children:\"Submit\"})]}),/*#__PURE__*/_jsxs(Dialog,{open:isDialogOpen,onClose:toggleDialog,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Confirm Submission\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Target:\"}),\" \",target]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"R.A.:\"}),\" \",ra]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Dec.:\"}),\" \",dec]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Exposure:\"}),\" \",exposure,\" seconds\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ObsMode:\"}),\" \",obsmode,\" \",obsmode===\"Spec\"&&`(${selectedSpecFile})`,obsmode===\"Deep\"&&`(Filters: ${selectedFilters.join(\", \")} | Telescopes: ${selectedTelNumber})`]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Comments:\"}),\" \",comments]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Abort Current Observation:\"}),\" \",abortObservation?'Yes':'No']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Single Frame Exposure:\"}),\" \",detailedSettings.singleFrameExposure,\" seconds\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"# of Images:\"}),\" \",detailedSettings.imageCount]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Priority:\"}),\" \",detailedSettings.priority]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Gain:\"}),\" \",detailedSettings.gain]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Binning:\"}),\" \",detailedSettings.binning]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Observation Start Time:\"}),\" \",detailedSettings.obsStartTime]})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:toggleDialog,color:\"secondary\",children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleSubmit,variant:\"contained\",color:\"primary\",disabled:isLoading,children:isLoading?/*#__PURE__*/_jsx(CircularProgress,{size:24,color:\"inherit\"}):'Confirm'})]})]}),isLoading&&/*#__PURE__*/_jsx(Snackbar,{open:true,children:/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:\"Sending email... Please wait.\"})}),successMessage&&/*#__PURE__*/_jsx(Snackbar,{open:true,autoHideDuration:6000,onClose:()=>setSuccessMessage(''),children:/*#__PURE__*/_jsx(Alert,{severity:\"success\",onClose:()=>setSuccessMessage(''),children:successMessage})}),error&&/*#__PURE__*/_jsx(Snackbar,{open:true,autoHideDuration:6000,onClose:()=>setError(''),children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",onClose:()=>setError(''),children:error})})]});};export default TargetForm;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","Autocomplete","Alert","TextField","Button","RadioGroup","FormControlLabel","Radio","Checkbox","Dialog","DialogTitle","DialogContent","DialogActions","Snackbar","CircularProgress","Chart","ChartJS","LinearScale","Title","Tooltip","ScatterController","LineController","LineElement","PointElement","CategoryScale","TimeScale","Legend","annotationPlugin","ExpandMoreIcon","ExpandLessIcon","SpecMode","DeepMode","DetailedSettings","CircleIcon","moment","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","register","TargetForm","targets","setTargets","target","setTarget","ra","setRa","dec","setDec","exposure","setExposure","obsmode","setObsmode","comments","setComments","abortObservation","setAbortObservation","requester","setRequester","wavelengths","setWavelengths","filters","setFilters","specFileOptions","setSpecFileOptions","selectedSpecFile","setSelectedSpecFile","selectedFilters","setSelectedFilters","selectedTelNumber","setSelectedTelNumber","staraltData","setStaraltData","isCustomTarget","setIsCustomTarget","isCollapsed","setIsCollapsed","isDetailCollapsed","setIsDetailCollapsed","isStaraltCollapsed","setIsStaraltCollapsed","isDialogOpen","setIsDialogOpen","isLoading","setIsLoading","error","setError","successMessage","setSuccessMessage","detailedSettings","setDetailedSettings","singleFrameExposure","imageCount","priority","gain","binning","obsStartTime","telescopesOnline","setTelescopesOnline","localTime","setLocalTime","tz","format","chartRef","staraltChartRef","get","then","response","data","catch","console","onlineTelescopes","table","filter","telescope","Status","length","raNum","parseFloat","decNum","isNaN","query","encodeURIComponent","fetch","json","log","current","objname","target_times","target_alts","moon_times","moon_alts","sun_times","sun_alts","color_target","tonight","target_minalt","target_minmoonsep","targetData","map","t","i","x","Date","y","moonData","sunData","mappedColorTarget","c","sunsetNight","sunset_night","sunriseNight","sunrise_night","sunsetCivil","sunset_civil","sunriseCivil","sunrise_civil","targetDataset","label","pointBackgroundColor","borderColor","showLine","pointRadius","moonDataset","backgroundColor","sunDataset","annotations","nightStartLine","type","xMin","getTime","xMax","borderWidth","enabled","content","position","yAdjust","nightEndLine","nightBox","yMin","yMax","drawTime","civilBox","minAltFill","font","weight","size","color","criteriaText","xValue","yValue","textAlign","_chart","chart","datasets","options","plugins","title","text","annotation","update","ctx","getContext","responsive","maintainAspectRatio","layout","padding","scales","time","unit","display","min","max","legend","labels","boxWidth","boxHeight","tooltip","mode","intersect","interaction","wavelengthChart","getChart","id","beforeDraw","xScale","forEach","wav","getPixelForValue","xCenter","gradient","createLinearGradient","addColorStop","fillStyle","fillRect","chartArea","top","bottom","strokeStyle","beginPath","moveTo","lineTo","stroke","yCenter","_wavelengthChart","destroy","interval","setInterval","clearInterval","handleSubmit","e","preventDefault","post","handleInputChange","event","value","selectedTarget","find","name","handleExposureChange","newExposure","newSingleFrameExposure","prev","handleBlur","trimmedExposure","replace","handleCheckboxChange","includes","item","toggleCollapse","toggleDetailCollapse","toggleStaraltCollapse","toggleDialog","emailRegex","test","isObservable","className","children","onSubmit","variant","onChange","fullWidth","required","getOptionLabel","option","inputValue","onInputChange","renderInput","params","freeSolo","disabled","onBlur","inputProps","step","style","justifyContent","row","control","onClick","checked","fontWeight","marginBottom","width","height","ref","marginTop","open","onClose","join","severity","autoHideDuration"],"sources":["/Users/dtak/Research/ToO/frontend/src/components/TargetForm.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport '../styles/TargetForm.css';\nimport {\n    Autocomplete,\n    Alert,\n    TextField,\n    Button,\n    RadioGroup,\n    FormControlLabel,\n    Radio,\n    Checkbox,\n    Dialog,\n    DialogTitle,\n    DialogContent,\n    DialogActions,\n    Snackbar,\n    CircularProgress,\n} from '@mui/material';\n\nimport 'chartjs-adapter-date-fns';\n\nimport {\n    Chart as ChartJS,\n    LinearScale,\n    Title,\n    Tooltip,\n    ScatterController,\n    LineController,\n    LineElement,\n    PointElement,\n    CategoryScale,\n    TimeScale,\n    Legend\n} from 'chart.js';\nimport annotationPlugin from 'chartjs-plugin-annotation';\n\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\nimport ExpandLessIcon from '@mui/icons-material/ExpandLess';\nimport SpecMode from './SpecMode';\nimport DeepMode from './DeepMode';\nimport DetailedSettings from './DetailedSettings';\nimport CircleIcon from '@mui/icons-material/Circle';\nimport moment from 'moment-timezone';\n\nChartJS.register(\n    LinearScale,\n    Title,\n    Tooltip,\n    ScatterController,\n    LineController,\n    LineElement,\n    PointElement,\n    CategoryScale,\n    TimeScale,\n    Legend,\n    annotationPlugin\n);\n\nconst TargetForm = () => {\n    const [targets, setTargets] = useState([]);\n    const [target, setTarget] = useState('');\n    const [ra, setRa] = useState('');\n    const [dec, setDec] = useState('');\n    const [exposure, setExposure] = useState('300');\n    const [obsmode, setObsmode] = useState('Spec'); \n    const [comments, setComments] = useState('');\n    const [abortObservation, setAbortObservation] = useState(false); // Track checkbox state\n    const [requester, setRequester] = useState(''); // Track requester email\n\n    const [wavelengths, setWavelengths] = useState([]);\n    const [filters, setFilters] = useState([]);\n    const [specFileOptions, setSpecFileOptions] = useState(['specall.specmode']);\n    const [selectedSpecFile, setSelectedSpecFile] = useState('specall.specmode');\n    const [selectedFilters, setSelectedFilters] = useState(['g']); // For checkboxes\n    const [selectedTelNumber, setSelectedTelNumber] = useState(10); // For dropdown\n    const [staraltData, setStaraltData] = useState(null);\n\n    const [isCustomTarget, setIsCustomTarget] = useState(true);\n    const [isCollapsed, setIsCollapsed] = useState(true); // Collapse state for mode options\n    const [isDetailCollapsed, setIsDetailCollapsed] = useState(true); // Collapse state for mode options\n    const [isStaraltCollapsed, setIsStaraltCollapsed] = useState(false); // Collapse state for mode options\n    const [isDialogOpen, setIsDialogOpen] = useState(false); // Dialog state\n    const [isLoading, setIsLoading] = useState(false);\n\n    const [error, setError] = useState('');\n    const [successMessage, setSuccessMessage] = useState('');\n\n    const [detailedSettings, setDetailedSettings] = useState({\n        singleFrameExposure: 60, // Default 60 seconds\n        imageCount: 5, // Default exposure time / 60\n        priority: 50, // Default 50\n        gain: 2750, // Default 2750\n        binning: 1, // Default 1\n        obsStartTime: '', // Default empty\n    });\n\n    const [telescopesOnline, setTelescopesOnline] = useState(0); // New state for telescope status\n    const [localTime, setLocalTime] = useState(moment().tz(\"America/Santiago\").format('YYYY-MM-DD HH:mm:ss'));\n\n    const chartRef = useRef(null);\n    const staraltChartRef = useRef(null);\n    \n\n    useEffect(() => {\n        axios\n            .get('/api/targets')\n            .then((response) => setTargets(response.data))\n            .catch((error) => console.error('Error fetching targets:', error));\n    }, []);\n\n    useEffect(() => {\n        if (obsmode === 'Spec') {\n            axios\n                .get('/api/spec-options')\n                .then((response) => setSpecFileOptions(response.data))\n                .catch((error) => console.error('Error fetching spec file options:', error));\n        }\n    }, [obsmode]);\n\n    useEffect(() => {\n        if (selectedSpecFile) {\n            axios\n                .get(`/api/spec-file?file=${selectedSpecFile}`)\n                .then((response) => {\n                    setWavelengths(response.data.wavelengths);\n                    setFilters(response.data.filters);\n                })\n                .catch((error) => console.error('Error fetching spec file data:', error));\n        }\n    }, [selectedSpecFile]);\n\n    useEffect(() => {\n        axios\n            .get('/api/status')\n            .then((response) => {\n                const onlineTelescopes = response.data.table.filter(telescope => telescope.Status !== 'offline').length;\n                setTelescopesOnline(onlineTelescopes);\n            })\n            .catch((error) => console.error('Error fetching telescope status:', error));\n    }, []);\n\n    useEffect(() => {\n        const raNum = parseFloat(ra);\n        const decNum = parseFloat(dec);\n        if (!isNaN(raNum) && !isNaN(decNum)) {\n            const query = `ra=${raNum}&dec=${decNum}&objname=${encodeURIComponent(target)}&target_minalt=30&target_minmoonsep=40`;\n            fetch(`/api/staralt_data?${query}`)\n                .then((response) => response.json())\n                .then((data) => {\n                    setStaraltData(data);\n                    console.log(\"Received staralt data:\", data);\n                })\n                .catch((error) => console.error(\"Error fetching staralt data:\", error));\n        }\n    }, [ra, dec, target]);\n\n    useEffect(() => {\n        if (!staraltData || !staraltChartRef.current) return;\n\n        const {\n            objname,\n            target_times, target_alts,\n            moon_times, moon_alts,\n            sun_times, sun_alts,\n            color_target,\n            tonight,\n            target_minalt,\n            target_minmoonsep\n        } = staraltData;\n\n        // Convert times to Date objects\n        const targetData = target_times.map((t, i) => ({ x: new Date(t), y: target_alts[i] }));\n        const moonData = moon_times.map((t, i) => ({ x: new Date(t), y: moon_alts[i] }));\n        const sunData = sun_times.map((t, i) => ({ x: new Date(t), y: sun_alts[i] }));\n\n        // Map color codes to CSS colors\n        const mappedColorTarget = color_target.map(c => {\n            if (c === 'r') return 'red';\n            if (c === 'k') return 'black';\n            if (c === 'g') return 'green';\n            return c; // fallback if needed\n        });\n\n        // Convert night times to Date objects\n        const sunsetNight = new Date(tonight.sunset_night);\n        const sunriseNight = new Date(tonight.sunrise_night);\n        const sunsetCivil = new Date(tonight.sunset_civil);\n        const sunriseCivil = new Date(tonight.sunrise_civil);\n\n        const targetDataset = {\n            label: 'Target',\n            data: targetData,\n            pointBackgroundColor: mappedColorTarget,\n            borderColor: 'black',\n            showLine: false,\n            pointRadius: 2\n        };\n\n        const moonDataset = {\n            label: 'Moon',\n            data: moonData,\n            borderColor: 'blue',\n            backgroundColor: 'blue',\n            showLine: false,\n            pointRadius: 1\n        };\n\n        const sunDataset = {\n            label: 'Sun',\n            data: sunData,\n            borderColor: 'red',\n            backgroundColor: 'red',\n            showLine: false,\n            pointRadius: 1\n        };\n\n        const annotations = {\n            // Vertical line at night start\n            nightStartLine: {\n                type: 'line',\n                xMin: sunsetNight.getTime(),\n                xMax: sunsetNight.getTime(),\n                borderColor: 'black',\n                borderWidth: 1,\n                label: {\n                    enabled: true,\n                    content: 'Night start',\n                    position: 'start',\n                    yAdjust: -20\n                }\n            },\n            // Vertical line at night end\n            nightEndLine: {\n                type: 'line',\n                xMin: sunriseNight.getTime(),\n                xMax: sunriseNight.getTime(),\n                borderColor: 'black',\n                borderWidth: 1,\n                label: {\n                    enabled: true,\n                    content: 'Night end',\n                    position: 'start',\n                    yAdjust: -20\n                }\n            },\n            // Shaded nighttime region\n            nightBox: {\n                type: 'box',\n                xMin: sunsetNight.getTime(),\n                xMax: sunriseNight.getTime(),\n                yMin: 0,\n                yMax: 90,\n                backgroundColor: 'rgba(0,0,0,0.3)',\n                drawTime: 'beforeDatasetsDraw'\n            },\n            // Shaded civil twilight region\n            civilBox: {\n                type: 'box',\n                xMin: sunsetCivil.getTime(),\n                xMax: sunriseCivil.getTime(),\n                yMin: 0,\n                yMax: 90,\n                backgroundColor: 'rgba(0,0,0,0.1)',\n                drawTime: 'beforeDatasetsDraw'\n            },\n            // Fill below minimum altitude line (red zone)\n            minAltFill: {\n                type: 'box',\n                xMin: sunsetNight.getTime(),\n                xMax: sunriseNight.getTime(),\n                yMin: 0,\n                yMax: target_minalt,\n                backgroundColor: 'rgba(255,0,0,0.3)',\n                drawTime: 'beforeDatasetsDraw',\n                label: {\n                    enabled: true,\n                    content: 'Observation limit',\n                    position: 'center',\n                    yAdjust: -50,\n                    font: { weight: 'bold', size: 12 },\n                    color: 'darkred'\n                }\n            },\n            // Add a text annotation with criteria\n            criteriaText: {\n                type: 'label',\n                xValue: new Date(sunsetNight.getTime() - 0.7 * 3600000), // 0.7 hours before night start\n                yValue: 80,\n                backgroundColor: 'rgba(255,255,255,0.7)',\n                borderColor: 'black',\n                borderWidth: 1,\n                color: 'black',\n                font: { size: 10, weight: 'bold' },\n                textAlign: 'left',\n                content: [\n                    `Current observation criteria:`,\n                    `- Altitude > ${target_minalt} deg`,\n                    `- Moon separation > ${target_minmoonsep} deg`\n                ]\n            }\n        };\n\n        // If the chart instance exists, update data and annotations\n        if (staraltChartRef.current._chart) {\n            const chart = staraltChartRef.current._chart;\n            chart.data.datasets = [sunDataset, moonDataset, targetDataset];\n            chart.options.plugins.title.text = objname ? `Altitude of ${objname}` : 'Altitude of the Target';\n            chart.options.plugins.annotation.annotations = annotations;\n            chart.update();\n        } else {\n            // Otherwise, create a new chart\n            const ctx = staraltChartRef.current.getContext('2d');\n            const chart = new ChartJS(ctx, {\n                type: 'line',\n                data: {\n                    datasets: [sunDataset, moonDataset, targetDataset]\n                },\n                options: {\n                    responsive: true,\n                    maintainAspectRatio: false, // Allow the chart to fill its container\n                    layout: {\n                        padding: 10\n                    },\n                    scales: {\n                        x: {\n                            type: 'time',\n                            time: {\n                                unit: 'hour'\n                            },\n                            title: {\n                                display: true,\n                                text: 'Time (UTC)'\n                            }\n                        },\n                        y: {\n                            title: {\n                                display: true,\n                                text: 'Altitude [deg]'\n                            },\n                            min: 0,\n                            max: 90\n                        }\n                    },\n                    plugins: {\n                        title: {\n                            display: true,\n                            text: objname ? `Altitude of ${objname}` : 'Altitude of the Target',\n                        },\n                        legend: {\n                            display: true,\n                            position: 'chartArea',\n                            labels: {\n                                boxWidth: 10,\n                                boxHeight: 10,\n                                padding: 10,\n                            }\n                        },\n                        tooltip: {\n                            mode: 'nearest',\n                            intersect: false\n                        },\n                        annotation: {\n                            annotations: annotations\n                        }\n                    },\n                    interaction: {\n                        mode: 'nearest',\n                        intersect: false\n                    }\n                }\n            });\n            staraltChartRef.current._chart = chart;\n        }\n    }, [staraltData, isStaraltCollapsed]);\n\n    useEffect(() => {\n        if (!chartRef.current) return;\n\n        const ctx = chartRef.current.getContext('2d');\n        let wavelengthChart = ChartJS.getChart(ctx);\n\n        if (!wavelengthChart) {\n            wavelengthChart = new ChartJS(ctx, {\n                type: 'scatter',\n                data: { labels: [''], datasets: [] },\n                options: {\n                    responsive: true,\n                    maintainAspectRatio: false,\n                    scales: {\n                        x: { type: 'linear', min: 3500, max: 9500, title: { display: false } },\n                        y: { display: false },\n                    },  \n                    plugins: { legend: { display: false } },\n                },\n                plugins: [\n                    {\n                        id: 'customSpans',\n                        beforeDraw: (chart) => {\n                            const ctx = chart.ctx;\n                            const xScale = chart.scales.x;\n                            wavelengths.forEach((wav) => {\n                                const xMin = xScale.getPixelForValue((wav - 12.5) * 10);\n                                const xMax = xScale.getPixelForValue((wav + 12.5) * 10);\n                                const xCenter = xScale.getPixelForValue(wav * 10);\n                                \n                                // Create gradient\n                                const gradient = ctx.createLinearGradient(xMin, 0, xMax, 0);\n                                gradient.addColorStop(0, 'black');\n                                gradient.addColorStop(0.1, 'darkgreen');\n                                gradient.addColorStop(0.5, 'green');\n                                gradient.addColorStop(0.9, 'darkgreen');\n                                gradient.addColorStop(1, 'black');\n\n                                // Draw the gradient span\n                                ctx.fillStyle = gradient;\n                                ctx.fillRect(\n                                    xMin,\n                                    chart.chartArea.top,\n                                    xMax - xMin,\n                                    chart.chartArea.bottom - chart.chartArea.top\n                                );\n                                // Draw the center line\n                                ctx.strokeStyle = 'darkgreen'; // You can change the color as needed\n                                ctx.beginPath();\n                                ctx.moveTo(xCenter, chart.chartArea.top);\n                                ctx.lineTo(xCenter, chart.chartArea.bottom);\n                                ctx.stroke();\n                                \n                                // Draw the horizontal center line\n                                const yCenter = (chart.chartArea.top + chart.chartArea.bottom) / 2;\n                                ctx.beginPath();\n                                ctx.moveTo(xMin, yCenter);\n                                ctx.lineTo(xMax, yCenter);\n                                ctx.stroke();\n                            });\n                        },\n                    },\n                ],\n            });\n        } else {\n            wavelengthChart.data.datasets = [];\n            wavelengthChart.update();\n        }\n\n        return () => wavelengthChart?.destroy();\n    }, [wavelengths, obsmode, isCollapsed]);\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            setLocalTime(moment().tz(\"America/Santiago\").format('YYYY-MM-DD HH:mm:ss'));\n        }, 1000);\n\n        return () => clearInterval(interval);\n    }, []);\n\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n\n        setIsLoading(true);\n        setError('');\n\n        try {\n            await axios.post('http://127.0.0.1:5000/api/send_email', {\n                requester,\n                target,\n                ra,\n                dec,\n                exposure,\n                obsmode,\n                comments,\n                abortObservation,\n                ...detailedSettings,\n                ...(obsmode === 'Deep' && { selectedFilters, selectedTelNumber }),\n                ...(obsmode === 'Spec' && { selectedSpecFile })\n            });\n            setSuccessMessage('Email sent successfully!');\n            setError('');\n            setIsDialogOpen(false); // Close dialog on success\n        } catch (error) {\n            setError('Failed to send the email. Please try again.');\n        } finally {\n            setIsLoading(false); // Stop loading\n        }\n    };\n\n    const handleInputChange = (event, value) => {\n        setTarget(value);\n        const selectedTarget = targets.find((t) => t.name === value);\n        if (selectedTarget) {\n            setRa(selectedTarget.ra);\n            setDec(selectedTarget.dec);\n            setIsCustomTarget(false);\n        } else {\n            setRa('');\n            setDec('');\n            setIsCustomTarget(true);\n        }\n    };\n\n    const handleExposureChange = (newExposure) => {\n        const { imageCount } = detailedSettings;\n        const newSingleFrameExposure = newExposure / imageCount;\n        setDetailedSettings((prev) => ({\n            ...prev,\n            singleFrameExposure: newSingleFrameExposure,\n        }));\n        setExposure(newExposure);\n    };\n\n    const handleBlur = () => {\n        // Remove leading zeros unless they are part of a decimal number\n        const trimmedExposure = exposure.replace(/^0+(?=\\d)/, '').replace(/^0*(\\.\\d+)/, '0$1');\n        setExposure(trimmedExposure);\n    };\n\n\n    const handleCheckboxChange = (filter) => {\n        setSelectedFilters((prev) =>\n            prev.includes(filter)\n                ? prev.filter((item) => item !== filter) // Remove filter if unchecked\n                : [...prev, filter] // Add filter if checked\n        );\n    };\n    \n    const toggleCollapse = () => {\n        setIsCollapsed(!isCollapsed);\n    };\n\n    const toggleDetailCollapse = () => {\n        setIsDetailCollapsed(!isDetailCollapsed);\n    };\n\n    const toggleStaraltCollapse = () => {\n        setIsStaraltCollapsed(!isStaraltCollapsed);\n    };\n\n    const toggleDialog = () => {\n        // Validate required fields\n        if (!ra || !dec || !requester || !target) {\n            setError('Fill all required fields: Requester, Target, R.A., Dec.');\n            return;\n        }\n\n        // Validate email format\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(requester)) {\n            setError('Please enter a valid email address.');\n            return;\n        }\n\n        // Check if the target is observable\n        const isObservable = staraltData.color_target.includes('g');\n        if (!isObservable) {\n            setError('The entered RA and DEC are not in any observable conditions. Check the visibility plot.');\n            return;\n        }\n\n        setIsDialogOpen(!isDialogOpen);\n    };\n\n    return (\n        <div className=\"container\">\n            <form onSubmit={handleSubmit} className=\"form\">\n\n                <div className=\"observing-conditions-box\">\n                    <div className=\"observing-conditions-header\">\n                        <label className=\"status-text\">Observing Status Overview</label>\n                    </div>\n                    <div className=\"observing-conditions-content\">\n                        <div className=\"status-indicator\">\n                            <span className=\"default-label\">Telescope:</span>\n                            <CircleIcon className={`status-icon ${telescopesOnline > 0 ? 'online' : 'offline'}`} />\n                            ({telescopesOnline} online)\n                        </div>\n                        <div className=\"local-time\">\n                            <span className=\"default-label\">Local Time:</span>\n                            <span className=\"time-text\">{localTime}</span> (RÃ­o Hurtado, Coquimbo, Chile)\n                        </div>\n                        {/* Future weather condition or other status can be added here */}\n                    </div>\n                </div>\n                \n                <div className=\"group-container\">\n                    <label className=\"default-label\">Requester:</label>\n                    <TextField\n                        label=\"Your email address\"\n                        variant=\"outlined\"\n                        value={requester}\n                        onChange={(e) => setRequester(e.target.value)}\n                        fullWidth\n                        className=\"input-field\"\n                        size=\"small\"\n                        type=\"email\"\n                        required\n                    />\n                </div>\n                <div className=\"group-container\">\n                    <label className=\"default-label\">Target:</label>\n                    <Autocomplete\n                        options={targets}\n                        getOptionLabel={(option) => option.name || ''}\n                        inputValue={target}\n                        onInputChange={handleInputChange}\n                        renderInput={(params) => (\n                            <TextField {...params} label=\"Target\" variant=\"outlined\" fullWidth size=\"small\" required/>\n                        )}\n                        freeSolo\n                        className=\"input-field\"\n                    />\n                </div>\n                <div className=\"group-container\">\n                    <label className=\"default-label\">R.A.:</label>\n                    <TextField\n                        label=\"hh:mm:ss or degrees\"\n                        variant=\"outlined\"\n                        value={ra}\n                        onChange={(e) => setRa(e.target.value)}\n                        fullWidth\n                        disabled={!isCustomTarget} \n                        className=\"input-field\"\n                        size=\"small\"\n                        required\n                    />\n                </div>\n                <div className=\"group-container\">\n                    <label className=\"default-label\">Dec.:</label>\n                    <TextField\n                        label=\"dd:mm:ss or degrees\"\n                        variant=\"outlined\"\n                        value={dec}\n                        onChange={(e) => setDec(e.target.value)}\n                        fullWidth\n                        disabled={!isCustomTarget} \n                        className=\"input-field\"\n                        size=\"small\"\n                        required\n                    />\n                </div>\n                <div className=\"group-container\">\n                    <label className=\"default-label\">Exposure:</label>\n                    <TextField\n                        label=\"seconds\"\n                        variant=\"outlined\"\n                        value={exposure}\n                        onChange={(e) => handleExposureChange(e.target.value || 0)}\n                        fullWidth\n                        className=\"input-field\"\n                        size=\"small\"\n                        type=\"number\"\n                        onBlur={handleBlur}\n                        inputProps={{\n                            step: 0.1, \n                        }}\n                    />\n                </div>\n                <div className=\"group-container\" style={{justifyContent: 'space-between'}}>\n                    <label className=\"default-label\">ObsMode:</label>\n                    <RadioGroup\n                        row\n                        value={obsmode}\n                        onChange={(e) => setObsmode(e.target.value)}\n                        className=\"radio-group\"\n                    >   \n                        <FormControlLabel\n                            value=\"Spec\"\n                            control={<Radio />}\n                            label=<span className=\"bold-label\">Spec</span>\n                        />\n                        <FormControlLabel\n                            value=\"Deep\"\n                            control={<Radio />}\n                            label=<span className=\"bold-label\">Deep</span>\n                        />\n                    </RadioGroup>\n                    <div className=\"collapse-toggle\" onClick={toggleCollapse}>\n                        {isCollapsed ? <ExpandMoreIcon /> : <ExpandLessIcon />}\n                        <span className=\"collapse-text\">\n                            {isCollapsed ? 'Expand' : 'Collapse'}\n                        </span>\n                    </div>\n                </div>\n\n                {!isCollapsed && (\n                    <>\n                    {obsmode === 'Spec' && (\n                        <SpecMode\n                            specFileOptions={specFileOptions}\n                            selectedSpecFile={selectedSpecFile}\n                            setSelectedSpecFile={setSelectedSpecFile}\n                            chartRef={chartRef}\n                            filters={filters}\n                        />\n                    )}\n                    {obsmode === 'Deep' && (\n                        <DeepMode\n                            selectedFilters={selectedFilters}\n                            handleCheckboxChange={handleCheckboxChange}\n                            selectedTelNumber={selectedTelNumber}\n                            setSelectedTelNumber={setSelectedTelNumber}\n                        />\n                    )}\n                    </>\n                )}\n                \n                <label className=\"default-label\">Comments:</label>\n                <TextField\n                        label=\"Any additional information\"\n                        variant=\"outlined\"\n                        value={comments}\n                        onChange={(e) => setComments(e.target.value)}\n                        fullWidth\n                        className=\"input-field\"\n                        size=\"small\"\n                />\n\n                <div className=\"group-container\">\n                    <FormControlLabel\n                        control={\n                            <Checkbox\n                                checked={abortObservation}\n                                onChange={(e) => setAbortObservation(e.target.checked)}\n                                color=\"primary\"\n                            />\n                        }\n                        style={{fontWeight:'bold'}}\n                        label={<span className=\"bold-label\">Abort Current Observation?</span>}\n                    />\n                </div>\n\n                <div className=\"collapse-toggle\" style={{marginBottom: \"0\"}} onClick={toggleStaraltCollapse}>\n                    {isStaraltCollapsed ? <ExpandMoreIcon /> : <ExpandLessIcon />}\n                    <span className=\"collapse-text\">\n                        {isStaraltCollapsed ? 'Show Visibility' : 'Hide Visibility'}\n                    </span>\n                </div>\n                {/* Display staralt plot */}\n                {!isStaraltCollapsed && (\n                    <>\n                    {staraltData && (\n                        <div style={{ width: '100%', height: '400px' }}>\n                            <canvas ref={staraltChartRef} style={{ width: '100%', height: '100%' }}></canvas>\n                        </div>\n                    )}\n                    </>\n                )}\n\n                <div className=\"collapse-toggle\"  style={{marginTop: \"0\"}} onClick={toggleDetailCollapse}>\n                    {isDetailCollapsed ? <ExpandMoreIcon /> : <ExpandLessIcon />}\n                    <span className=\"collapse-text\">\n                        {isDetailCollapsed ? 'Show Detailed Settings' : 'Hide Detailed Settings'}\n                    </span>\n                </div>\n\n                {!isDetailCollapsed && (\n                    <>\n                        <DetailedSettings\n                            detailedSettings={detailedSettings}\n                            setDetailedSettings={setDetailedSettings}\n                            exposure={exposure}\n                            setExposure={setExposure}\n                        />\n                    </>\n                )}\n\n                <Button\n                    type=\"button\"\n                    variant=\"contained\"\n                    color=\"primary\"\n                    className=\"submit-button\"\n                    onClick={toggleDialog}\n                >\n                    Submit\n                </Button>\n            </form>\n            <Dialog open={isDialogOpen} onClose={toggleDialog}>\n                <DialogTitle>Confirm Submission</DialogTitle>\n                <DialogContent>\n                    <p><strong>Target:</strong> {target}</p>\n                    <p><strong>R.A.:</strong> {ra}</p>\n                    <p><strong>Dec.:</strong> {dec}</p>\n                    <p><strong>Exposure:</strong> {exposure} seconds</p>\n                    <p>\n                        <strong>ObsMode:</strong> {obsmode}{\" \"}\n                        {obsmode === \"Spec\" && `(${selectedSpecFile})`}\n                        {obsmode === \"Deep\" && `(Filters: ${selectedFilters.join(\", \")} | Telescopes: ${selectedTelNumber})`}\n                    </p>\n                    <p><strong>Comments:</strong> {comments}</p>\n                    <p><strong>Abort Current Observation:</strong> {abortObservation ? 'Yes' : 'No'}</p>\n                    <p><strong>Single Frame Exposure:</strong> {detailedSettings.singleFrameExposure} seconds</p>\n                    <p><strong># of Images:</strong> {detailedSettings.imageCount}</p>\n                    <p><strong>Priority:</strong> {detailedSettings.priority}</p>\n                    <p><strong>Gain:</strong> {detailedSettings.gain}</p>\n                    <p><strong>Binning:</strong> {detailedSettings.binning}</p>\n                    <p><strong>Observation Start Time:</strong> {detailedSettings.obsStartTime}</p>\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={toggleDialog} color=\"secondary\">\n                        Cancel\n                    </Button>\n                    <Button \n                        onClick={handleSubmit} \n                        variant=\"contained\" \n                        color=\"primary\"\n                        disabled={isLoading}\n                    >\n                        {isLoading ? <CircularProgress size={24} color=\"inherit\" /> : 'Confirm'}\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n\n            {/* Loading Message */}\n            {isLoading && (\n                <Snackbar open>\n                    <Alert severity=\"info\">\n                        Sending email... Please wait.\n                    </Alert>\n                </Snackbar>\n            )}\n\n\n            {/* Success Message */}\n            {successMessage && (\n                <Snackbar open autoHideDuration={6000} onClose={() => setSuccessMessage('')}>\n                    <Alert severity=\"success\" onClose={() => setSuccessMessage('')}>\n                        {successMessage}\n                    </Alert>\n                </Snackbar>\n            )}\n\n            {/* Error Message */}\n            {error && (\n                <Snackbar open autoHideDuration={6000} onClose={() => setError('')}>\n                    <Alert severity=\"error\" onClose={() => setError('')}>\n                        {error}\n                    </Alert>\n                </Snackbar>\n            )}\n\n\n        </div>\n    );\n}\n\nexport default TargetForm;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}